<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Akeneo UI Extension Test</title>
</head>
<body>
  <h1>Hello from UI Extension</h1>
  <p>Select products and check the console.</p>

  <script>
    console.log("ðŸ“¨ Requesting context from Akeneo...");

    // Ask Akeneo for context
    window.parent.postMessage(
      {
        type: "pim/ui-extension/product-grid/request-context"
      },
      "*"
    );

    // Listen for response from Akeneo
    window.addEventListener("message", (event) => {
      console.log("ðŸ”” Message received from:", event.origin);
      console.log("ðŸ“¦ Message data:", event.data);

      if (
        event.data?.type === "pim/ui-extension/product-grid/context" &&
        event.data.context
      ) {
        const selected = event.data.context.selectedProductCodes || [];
        console.log("âœ… Selected products:", selected);

        // Optional: Send response back to Akeneo
        window.parent.postMessage(
          {
            type: "pim/ui-extension/response",
            result: "success",
            message: "Received selected products"
          },
          "*"
        );
      }
    });
  </script>
</body>
</html>
